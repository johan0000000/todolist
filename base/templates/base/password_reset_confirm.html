{% extends 'base/main.html' %}

{% block content %}
<div class="auth-container">
  {% if form %}
    <h2 class="auth-title">Reset Your Password</h2>

    <form method="post">
      {% csrf_token %}

      <div class="auth-form-fields">
        <div class="form-group">
          <label for="{{ form.new_password1.id_for_label }}">New Password</label>
          {{ form.new_password1 }}
          {% for error in form.new_password1.errors %}
            <div class="error-message">{{ error }}</div>
          {% endfor %}
        </div>
        
        <div class="form-group">
          <label for="{{ form.new_password2.id_for_label }}">Confirm Password</label>
          {{ form.new_password2 }}
          {% for error in form.new_password2.errors %}
            <div class="error-message">{{ error }}</div>
          {% endfor %}
        </div>

        {% if form.non_field_errors %}
          {% for error in form.non_field_errors %}
            <div class="error-message">{{ error }}</div>
          {% endfor %}
        {% endif %}
      </div>

      <button type="submit" class="auth-button">Change Password</button>
    </form>

  {% else %}
    <p class="auth-error">Invalid or expired link</p>
  {% endif %}
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const messages = document.querySelectorAll(".error-message");
    if (messages.length === 0) return;

    messages.forEach((msg) => {
      msg.style.transition = 'opacity 0.4s ease, transform 0.4s ease';

      setTimeout(() => {
        msg.style.opacity = '0';
        msg.style.transform = 'translateY(-10px)';
      }, 2600);

      setTimeout(() => {
        if (msg.parentNode) {
          msg.parentNode.removeChild(msg);
        }
      }, 3000);
    });
  });
</script>
{% endblock %}
